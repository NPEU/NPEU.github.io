/*! --------------------------------------------------------------------------------------------- *\
    
    Fall-Back Search Form vNEXT
    https://github.com/Fall-Back/Patterns/tree/master/Search%20Form
    Copyright (c) 2021, Andy Kirk
    Released under the MIT license https://git.io/vwTVl

    Designed for use with the EM2 [CSS Mustard Cut](https://github.com/Fall-Back/CSS-Mustard-Cut)
    Edge, Chrome 39+, Opera 26+, Safari 9+, iOS 9+, Android ~5+, Android UCBrowser ~11.8+
    FF 47+

    PLUS IE11

\* ---------------------------------------------------------------------------------------------- */


$s__search-form--breakpoint--enhanced:         $s__breakpoint--enhanced;


// Colours:

$s__search-form--base-ui-color:                 $s__base-ui-color !default;
$s__search-form--base-text-color:               $s__base-text-color !default;

$s__search-form--background-color:              $s__search-form--base-ui-color !default;


$s__search-form__field--background-color:       $s__base-background-color !default;
$s__search-form__field--background-color--alt:  #ffffdc !default;
$s__search-form__field--text-color:             $s__search-form--base-text-color !default;


$s__search-form__submit--background-color:      lighten($s__search-form--base-ui-color, 50%) !default;
$s__search-form__submit--background-color--alt: lighten($s__search-form--base-ui-color, 30%) !default;
$s__search-form__submit--text-color:            $s__search-form--base-text-color !default;

// Sizes:

$s__search-form--font-size:                     $s__base-font-size !default;
$s__search-form--field-height:                  $s__base-em-ratio * 1em !default;
$s__search-form--spacing:                       $s__search-form--field-height / 8 !default;
$s__search-form--height:                        $s__search-form--field-height + ($s__search-form--spacing * 2) !default;

$s__search-bar--height:                         $s__search-form--height + ($s__search-form--spacing * 2) !default;
$s__search-bar-button--spacing:                 $s__search-bar--height / 8 !default;



$s__search-form-max-width:                      25em !default;


/* -- Basic/fallback layout --------------------------------------------------------------------- */

    /* -- .search-form ---------------------------------------------------------------------------*/

    /*
        1. Prevent extra bottom space when form is inside a container.
    */
    .search-form.search-form {
        background: $s__search-form--background-color;

        display: flex;
        flex-wrap: wrap;

        margin: 0;

        width: 100%;

        vertical-align: top;
    }


    .search-form.search-form::before,
    .search-form.search-form::after {
        content: " ";
        display: table;
    }

    .search-form.search-form::after {
        clear: both;
    }


    .search-form---restrict-width {
        max-width: $s__search-form-max-width;
    }

    /* -------------------------------------------------------------------------------------------*/


    /* -- .search-form__field --------------------------------------------------------------------*/

    /*
        1. Override default size attr value - mainly for Opera mini which wierdley needs both
           width AND min-width.
    */
    .search-form .search-form__field {
        position: relative;
        z-index: 1;

        border-radius: 0;
        border: 0;


        background-color: $s__search-form__field--background-color;
        color: $s__search-form__field--text-color;
        height: $s__search-form--field-height;
        line-height: $s__search-form--field-height;
        margin: $s__search-form--spacing 0 $s__search-form--spacing $s__search-form--spacing;
        padding: $s__search-form--spacing;

        //float: left;

        flex: 1 1 auto;


        width: 1%;     /* [1] */
        min-width: 1%; /* [1] */
    }

    // Reset the width for FF8-27: ...
    @media screen and (min--moz-device-pixel-ratio:0) and (min-resolution:.001dpcm) {
        .search-form .search-form__field {
            width: auto;
        }
    }
    // And IE9
    @media #{$s__ie9} {
        .search-form .search-form__field {
            width: auto;
        }
    }
    
    // ... but put it back for FF28+:
    @supports (-moz-appearance:none) and (list-style-type:japanese-formal) {
        .search-form .search-form__field {
            width: 1%;
        }
    }


    .search-form .search-form__field:focus {
        background-color: $s__search-form__field--background-color--alt;
    }

    /* -------------------------------------------------------------------------------------------*/


    /* -- .search-form__submit -------------------------------------------------------------------*/

    /*
    */
    .search-form .search-form__submit {
        position: relative;
        z-index: 1;

        border-radius: 0;
        border: 0;


        background: $s__search-form__submit--background-color;
        color: $s__search-form__submit--text-color;

        height: $s__search-form--height;
        line-height: 0;

        margin: $s__search-form--spacing $s__search-form--spacing $s__search-form--spacing 0;
        padding:  0 ($s__search-form--spacing * 2);

        //float: left;

        flex: 0 0 auto;
    }

    .search-form .search-form__submit:hover,
    .search-form .search-form__submit:focus {
        background-color: $s__search-form__submit--background-color--alt;
    }


    .js-cmr--wide .serach-form--push-right--wide {
        margin-left: auto;
    }


    /* -------------------------------------------------------------------------------------------*/

/* -----------------------------------------------------------------------------------------------*/

/* -- Enhanced layout --------------------------------------------------------------------------- */
    .js-cmr--narrow {


        .search-form .search-form__collapse {
            width: 100%;
        }
    }

    .js-cmr--wide {

        /*
            1. Reinstate all flexbox for enhanced view as no wrapping needs to occure
            (FF8-27 issue describbed above)
        */
        .search-form.search-form {
            display: flex; /* [1] */

            flex-wrap: nowrap;
        }

        .search-form .search-form__field {
            width: auto;
        }

    }
/* ---------------------------------------------------------------------------------------------- */